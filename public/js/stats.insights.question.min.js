!function(t,e,n,a){"use strict";function i(e){return t("#"+e).append(t("<div>",{id:e+"-chart"})),n.Donut({element:e+"-chart",data:[{label:"loading",value:""}],resize:!0})}function o(e){return t("#"+e).append(t("<div>",{id:e+"-chart"})),n.Bar({element:e+"-chart",data:[],xkey:"key",ykeys:["doc_count"],labels:["Aantal"]}).on("click",function(t,e,n){v(e,1)})}function s(e,n){var a=t("#question-multiple-choise");n.multiple_choise?(a.show(),e.setData(n.answers)):a.hide()}function u(e,n){var a=t("#question-regular");n.terms.buckets.length>0?(a.show(),e.setData(n.terms.buckets)):a.hide()}function l(e,n){t("#question-term").hide();var a=t("#panel").val(),i=t("#question").val();t.ajax({url:"/stats/insights/question",type:"POST",dataType:"json",data:{panel:a,question:i},success:function(a){r(a),s(n,a),u(e,a),a.questions&&p(a.questions);var i=0;i=t("#panel option:last-child").attr("value")!=t("#panel").val()?t("#question option").size()+1:t("#question option").size();var o=!1;t("#panel option:first-child").attr("value")!=t("#panel").val()&&(o=!0),h(t("#question-panel"),{current_page:d,last_page:i},o)}})}function r(e){var n=t("#question-title"),a=t("#question-info"),i=t("#question-meta"),o=t("#question-options");if(n.html(e.question.title),a.html(e.question.question),i.html(e.question.meta),e.question.meta?i.show():i.hide(),o.html(""),e.multiple_choise){var s=t("<ul>");_.each(e.question.choises,function(e){s.append(t("<li>",{html:e.title}))})}o.append(s)}function p(e){var n=t("#question");n.html(""),_.each(e,function(e){n.append(t("<option>",{value:e.id,html:e.label}))})}function c(){var e=t("#question");e.html("")}function h(e,n,a){"undefined"==typeof a&&(a=!1),e.find(".pager-previous, .pager-next").remove(),(n.current_page>1||a)&&e.append(t("<a>",{"class":"pager-previous btn btn-primary",html:'<i class="fa fa-arrow-left"></i>'})),n.current_page<n.last_page&&e.append(t("<a>",{"class":"pager-next btn btn-primary",html:'<i class="fa fa-arrow-right"></i>'}))}function v(e,n){f=e,g=n,t.ajax({url:"/stats/insights/term",type:"POST",dataType:"json",data:{question:t("#question").val(),term:e.key,page:n},success:function(e){var n=t("#question-term");n.html(""),n.show(),_.each(e.data,function(e){n.append(t("<p>",{html:e.explanation}))}),h(n,e)}})}a.locale("nl");var d=1,f=!1,g=!1;t(document).ready(function(){var e=i("question-multiple-choise"),n=o("question-regular"),a=t("#question-panel");l(n,e),t("#panel").on("change",function(){c(),d=1,l(n,e)}),t("#question").on("change",function(){var a=t(this).val();t(this).find("option").each(function(e,n){t(n).attr("value")==a&&(d=e+1)}),l(n,e)}),t("#question-term").on("click",".pager-previous",function(t){v(f,g-1),t.stopPropagation(),t.preventDefault()}).on("click",".pager-next",function(t){v(f,g+1),t.stopPropagation(),t.preventDefault()}),h(a,{current_page:1,last_page:t("#question option").size()}),a.on("click",".pager-previous",function(e){var n=t("#question option:nth-child("+(d-1)+")");if(n.size())t("#question").val(n.attr("value")).trigger("change");else{var a=_.findIndex(t("#panel option"),function(e){return t(e).attr("value")==t("#panel").val()});a>0&&t("#panel").val(t("#panel option:nth-child("+a+")").attr("value")).trigger("change")}e.stopPropagation(),e.preventDefault()}).on("click",".pager-next",function(e){var n=t("#question option:nth-child("+(d+1)+")");n.size()?t("#question").val(n.attr("value")).trigger("change"):(n=t("#panel option:selected + option"),n.size()&&t("#panel").val(n.attr("value")).trigger("change")),e.stopPropagation(),e.preventDefault()})})}(window.jQuery,window.app,window.Morris,window.moment);